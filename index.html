<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Precision Nutrition Logger</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header .date {
            font-size: 14px;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            flex-wrap: wrap;
        }

        .nav-tab {
            flex: 1;
            padding: 12px 8px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            min-width: 80px;
        }

        .nav-tab.active {
            background: white;
            color: #4facfe;
            border-bottom: 2px solid #4facfe;
        }

        .tab-content {
            display: none;
            padding: 20px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 14px;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #4facfe;
        }

        .rating-buttons {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 4px;
            margin-top: 8px;
        }

        .rating-btn {
            padding: 8px 4px;
            border: 1px solid #e9ecef;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
        }

        .rating-btn:hover {
            border-color: #4facfe;
            background: #f0f8ff;
        }

        .rating-btn.selected {
            background: #4facfe;
            color: white;
            border-color: #4facfe;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: transform 0.2s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
        }

        .reminder-card {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .reminder-card h4 {
            color: #155724;
            margin-bottom: 8px;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
            text-align: center;
            display: none;
        }

        .meal-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .meal-section h3 {
            color: #4facfe;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .time-input {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .scale-info {
            background: #f8f9fa;
            padding: 8px;
            border-radius: 6px;
            margin-top: 5px;
            font-size: 11px;
            color: #666;
        }

        .data-summary {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .data-summary h3 {
            color: #28a745;
            margin-bottom: 10px;
        }

        .export-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 14px;
        }

        .data-entry {
            background: white;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 10px;
            border-left: 3px solid #4facfe;
            font-size: 12px;
        }

        .data-entry-date {
            font-weight: bold;
            color: #4facfe;
        }

        @media (max-width: 480px) {
            .rating-buttons {
                grid-template-columns: repeat(5, 1fr);
                gap: 6px;
            }
            
            .rating-btn {
                padding: 10px 6px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü•ó Precision Nutrition</h1>
            <div class="date" id="currentDate"></div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('morning')">Morning</button>
            <button class="nav-tab" onclick="showTab('meals')">Meals</button>
            <button class="nav-tab" onclick="showTab('data')">Data</button>
        </div>

        <!-- Morning Tab -->
        <div id="morning" class="tab-content active">
            <div class="success-message" id="morningSuccess">
                ‚úÖ Morning data saved successfully!
            </div>
            
            <div class="reminder-card">
                <h4>üåÖ Morning Checklist</h4>
                <p>Log your overnight recovery data and plan your day!</p>
            </div>

            <div class="form-group">
                <label>Wake Time</label>
                <input type="time" id="wakeTime">
            </div>

            <div class="form-group">
                <label>Morning Energy (1-10)</label>
                <div class="rating-buttons" data-field="morningEnergy">
                    <button class="rating-btn" data-value="1">1</button>
                    <button class="rating-btn" data-value="2">2</button>
                    <button class="rating-btn" data-value="3">3</button>
                    <button class="rating-btn" data-value="4">4</button>
                    <button class="rating-btn" data-value="5">5</button>
                    <button class="rating-btn" data-value="6">6</button>
                    <button class="rating-btn" data-value="7">7</button>
                    <button class="rating-btn" data-value="8">8</button>
                    <button class="rating-btn" data-value="9">9</button>
                    <button class="rating-btn" data-value="10">10</button>
                </div>
                <div class="scale-info">1=Exhausted, 5=Neutral, 10=Peak energy</div>
            </div>

            <div class="meal-section">
                <h3>üì± Health Data</h3>
                <div class="time-input">
                    <div class="form-group">
                        <label>Weight (lbs)</label>
                        <input type="number" step="0.1" id="weight" placeholder="165.2">
                    </div>
                    <div class="form-group">
                        <label>Sleep Hours</label>
                        <input type="number" step="0.1" id="sleepHours" placeholder="7.5">
                    </div>
                </div>
            </div>

            <button class="btn-primary" onclick="saveMorningData()">Save Morning Data</button>
        </div>

        <!-- Meals Tab -->
        <div id="meals" class="tab-content">
            <div class="success-message" id="mealSuccess">
                ‚úÖ Meal data saved successfully!
            </div>
            
            <div class="reminder-card">
                <h4>üçΩÔ∏è Meal Logging</h4>
                <p>Track what you eat and how it makes you feel!</p>
            </div>

            <div class="meal-section">
                <h3>Breakfast</h3>
                <div class="form-group">
                    <label>Time</label>
                    <input type="time" id="breakfastTime">
                </div>
                
                <div class="form-group">
                    <label>Food Description</label>
                    <textarea id="breakfastFood" placeholder="e.g., Greek yogurt with berries" rows="2"></textarea>
                </div>

                <div class="form-group">
                    <label>Energy 1hr Later (1-10)</label>
                    <div class="rating-buttons" data-field="breakfastEnergy">
                        <button class="rating-btn" data-value="1">1</button>
                        <button class="rating-btn" data-value="2">2</button>
                        <button class="rating-btn" data-value="3">3</button>
                        <button class="rating-btn" data-value="4">4</button>
                        <button class="rating-btn" data-value="5">5</button>
                        <button class="rating-btn" data-value="6">6</button>
                        <button class="rating-btn" data-value="7">7</button>
                        <button class="rating-btn" data-value="8">8</button>
                        <button class="rating-btn" data-value="9">9</button>
                        <button class="rating-btn" data-value="10">10</button>
                    </div>
                </div>
            </div>

            <div class="meal-section">
                <h3>Lunch</h3>
                <div class="form-group">
                    <label>Time</label>
                    <input type="time" id="lunchTime">
                </div>
                
                <div class="form-group">
                    <label>Food Description</label>
                    <textarea id="lunchFood" placeholder="e.g., Salad with chicken" rows="2"></textarea>
                </div>

                <div class="form-group">
                    <label>Energy 1hr Later (1-10)</label>
                    <div class="rating-buttons" data-field="lunchEnergy">
                        <button class="rating-btn" data-value="1">1</button>
                        <button class="rating-btn" data-value="2">2</button>
                        <button class="rating-btn" data-value="3">3</button>
                        <button class="rating-btn" data-value="4">4</button>
                        <button class="rating-btn" data-value="5">5</button>
                        <button class="rating-btn" data-value="6">6</button>
                        <button class="rating-btn" data-value="7">7</button>
                        <button class="rating-btn" data-value="8">8</button>
                        <button class="rating-btn" data-value="9">9</button>
                        <button class="rating-btn" data-value="10">10</button>
                    </div>
                </div>
            </div>

            <button class="btn-primary" onclick="saveMealData()">Save Meal Data</button>
        </div>

        <!-- Data Tab -->
        <div id="data" class="tab-content">
            <div class="data-summary">
                <h3>üìä Your Nutrition Database</h3>
                <p>View and export your logged data.</p>
            </div>

            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 24px; font-weight: bold; color: #4facfe;" id="totalEntries">0</div>
                <div style="font-size: 12px; color: #666;">Total Entries</div>
            </div>

            <button class="export-btn" onclick="exportToCSV()">üìÅ Export to CSV</button>
            <button class="export-btn" onclick="clearAllData()" style="background: #dc3545;">üóëÔ∏è Clear All Data</button>

            <div id="recentEntries"></div>
        </div>
    </div>

    <script>
        // Initialize the app
        let nutritionData = {
            morning: [],
            meals: []
        };

        // Load existing data on startup
        loadData();
        updateCurrentDate();
        updateDataSummary();

        // Set current date
        function updateCurrentDate() {
            const today = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('currentDate').textContent = today.toLocaleDateString('en-US', options);
        }

        // Tab switching
        function showTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Update data when viewing data tab
            if (tabName === 'data') {
                updateDataSummary();
                displayRecentEntries();
            }
        }

        // Rating button functionality
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('rating-btn')) {
                const container = e.target.parentElement;
                const buttons = container.querySelectorAll('.rating-btn');
                
                // Remove selected class from all buttons in this group
                buttons.forEach(btn => btn.classList.remove('selected'));
                
                // Add selected class to clicked button
                e.target.classList.add('selected');
                
                // Store the value for form submission
                const field = container.getAttribute('data-field');
                const value = e.target.getAttribute('data-value');
                container.setAttribute('data-selected-value', value);
            }
        });

        // Save morning data
        function saveMorningData() {
            const morningEntry = {
                date: new Date().toISOString().split('T')[0],
                timestamp: new Date().toISOString(),
                wakeTime: document.getElementById('wakeTime').value,
                morningEnergy: getRatingValue('morningEnergy'),
                weight: document.getElementById('weight').value,
                sleepHours: document.getElementById('sleepHours').value
            };

            nutritionData.morning.push(morningEntry);
            saveData();
            showSuccess('morningSuccess');
            clearMorningForm();
        }

        // Save meal data
        function saveMealData() {
            const mealEntry = {
                date: new Date().toISOString().split('T')[0],
                timestamp: new Date().toISOString(),
                breakfast: {
                    time: document.getElementById('breakfastTime').value,
                    food: document.getElementById('breakfastFood').value,
                    energy: getRatingValue('breakfastEnergy')
                },
                lunch: {
                    time: document.getElementById('lunchTime').value,
                    food: document.getElementById('lunchFood').value,
                    energy: getRatingValue('lunchEnergy')
                }
            };

            nutritionData.meals.push(mealEntry);
            saveData();
            showSuccess('mealSuccess');
            clearMealForm();
        }

        // Helper functions
        function getRatingValue(fieldName) {
            const container = document.querySelector(`[data-field="${fieldName}"]`);
            return container ? container.getAttribute('data-selected-value') : null;
        }

        function showSuccess(elementId) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            setTimeout(() => {
                element.style.display = 'none';
            }, 3000);
        }

        function clearMorningForm() {
            document.getElementById('wakeTime').value = '';
            document.getElementById('weight').value = '';
            document.getElementById('sleepHours').value = '';
            clearRatingButtons('morningEnergy');
        }

        function clearMealForm() {
            document.getElementById('breakfastTime').value = '';
            document.getElementById('breakfastFood').value = '';
            document.getElementById('lunchTime').value = '';
            document.getElementById('lunchFood').value = '';
            clearRatingButtons('breakfastEnergy');
            clearRatingButtons('lunchEnergy');
        }

        function clearRatingButtons(fieldName) {
            const container = document.querySelector(`[data-field="${fieldName}"]`);
            if (container) {
                const buttons = container.querySelectorAll('.rating-btn');
                buttons.forEach(btn => btn.classList.remove('selected'));
                container.removeAttribute('data-selected-value');
            }
        }

        // Data persistence functions
        function saveData() {
            try {
                localStorage.setItem('nutritionTrackerData', JSON.stringify(nutritionData));
            } catch (error) {
                console.error('Error saving data:', error);
                alert('Error saving data. Your browser may not support data storage.');
            }
        }

        function loadData() {
            try {
                const saved = localStorage.getItem('nutritionTrackerData');
                if (saved) {
                    nutritionData = JSON.parse(saved);
                }
            } catch (error) {
                console.error('Error loading data:', error);
                nutritionData = { morning: [], meals: [] };
            }
        }

        // Data display functions
        function updateDataSummary() {
            const totalEntries = nutritionData.morning.length + nutritionData.meals.length;
            document.getElementById('totalEntries').textContent = totalEntries;
        }

        function displayRecentEntries() {
            const container = document.getElementById('recentEntries');
            const allEntries = [
                ...nutritionData.morning.map(entry => ({...entry, type: 'Morning'})),
                ...nutritionData.meals.map(entry => ({...entry, type: 'Meals'}))
            ].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp)).slice(0, 5);

            container.innerHTML = '<h4>Recent Entries</h4>';
            allEntries.forEach(entry => {
                const div = document.createElement('div');
                div.className = 'data-entry';
                div.innerHTML = `
                    <div class="data-entry-date">${entry.type} - ${new Date(entry.timestamp).toLocaleDateString()}</div>
                    <div>${entry.type === 'Morning' ? 
                        `Energy: ${entry.morningEnergy || 'N/A'}, Weight: ${entry.weight || 'N/A'}` :
                        `Breakfast: ${entry.breakfast?.food || 'N/A'}`}</div>
                `;
                container.appendChild(div);
            });
        }

        // Export function
        function exportToCSV() {
            let csv = 'Date,Type,Data\n';
            
            nutritionData.morning.forEach(entry => {
                csv += `${entry.date},Morning,"Energy: ${entry.morningEnergy}, Weight: ${entry.weight}"\n`;
            });
            
            nutritionData.meals.forEach(entry => {
                csv += `${entry.date},Meals,"Breakfast: ${entry.breakfast?.food || 'N/A'}"\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', `nutrition-data-${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        // Clear all data
        function clearAllData() {
            if (confirm('Are you sure you want to delete all your nutrition data? This cannot be undone.')) {
                nutritionData = { morning: [], meals: [] };
                saveData();
                updateDataSummary();
                displayRecentEntries();
                alert('All data has been cleared.');
            }
        }
    </script>
</body>
</html>
